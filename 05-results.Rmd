# Results

```{r, include=FALSE}
# this prevents package loading message from appearing in the rendered version of your problem set
knitr::opts_chunk$set(warning = FALSE, message = FALSE,
                      echo = FALSE)
```

```{r}
library(rvest)
library(robotstxt)
library(tidyverse) 
library(patchwork)
library(naniar)
library(janitor)
library(vistime)
```

## Different iPhone Features Changing

In order for us to better understand how products are changing to suit the public’s varying needs, it is necessary to examine the change of products’ features over the year. As an iconic figure among all Apple products, iPhone can be a typical product for our analysis. In this section, we will take deep analysis on the features of different generations of iPhone products, like the release date and discontinued date, display of the phone, and the rear camera mode. In our data cleaning section, we have obtained the data that contain those essential information, and we will utilize these data and a vast of R libraries including tidyverse, rvest, robotstxt, patchwork, naniar, janitor, and vistime to help our exploratory analysis. 

### Release and Discontinued Date
Before we dive into the various features of the iPhone, we want to present a roadmap of when each iPhone was produced and when it was discontinued from production. For our purpose, we utilize the vistime library to draw the visualization. 
```{r}
vistime(iph_rel, col.event="Model", col.start = "ReleaseDate", col.end = "DisconDate", optimize_y = TRUE)
```

Vistime allows us to interact with the graph. If we point at the box where each iPhone is located, we can clearly see when the iPhone is produced and when it’s discontinued. As we can see from the graph, the earliest iPhone was produced in 2008, and it is the first generation of iPhone, but the product only lasts for one year. Similar fate can be seen on iPhone 3G or iPhone 5, where we can imply that Apple was facing certain challenges as they first started producing the iPhone product. As Apple continues on producing the iPhone products, we can see their production lasts longer than before, which may be caused by their more stabilized or newer technology. However, there is one thing we notice from the graph about the iPhone 4. Although it’s among one of the earliest iPhones, it’s production lasts comparatively longer than other early iPhones. Also, during the period of iPhone 4, Apple started producing iPhone more frequently and introducing more new types of iPhone. This tells us that iPhone 4 symbolizes one of the early successes in Apply history.

```{r}
ggplot(iph_rel, aes(x=ReleaseYear)) +
  geom_bar() +
  ggtitle("Number of iPhone Models Released in Each Year")
```

As we can see from the bar graph of numbers of the iPhones released in each year, we can see that Apple continues to release more and more iPhone products in the last 15 years. Apple reaches at most 5 models in 2020. In particular, the year 2013 can be seen as a growth point of iPhone models. Before 2013, Apple only released one model a year, but after 2013, Apple started releasing more than 2 models a year. We can imply that Apple reached success in making iPhone models in 2013, and they were more confident to produce more various models in the following years. This implication allows us to relate back to the findings we get at the end of the Vistime graph. As we said, iPhone 4 can be seen as one of the early successes in Apple history. And if we look back at the production period of iPhone 4, which is 2010-2013, we can see that the success of iPhone 4 perfectly matches the growth point of iPhone models. 

### iPhone Display Table
We found a dataset about the information of the display of each iPhone model. Given the dataset, we want to visualize the relationship among different iPhone features. Therefore, we provide a parallel coordinate plot for different iPhone models. Since the original dataset contains fairly detailed information about different features of iPhone models, for the sake of simplicity and clarity, we only selected a few important features for the public if they select the iPhones, including pixel density, aspect ratio, typical max brightness, contrast ratio, etc. To avoid the overlap of the feature names in the plot, we have abbreviated the feature names. 

```{r}
library(parcoords)
library(d3r)
library(RColorBrewer)

cleanNA_display <- r_display
cleanNA_display[is.na(cleanNA_display)] <- "NA"
colnames(cleanNA_display) <- abbreviate(names(cleanNA_display), minlength=5)

parcoords(cleanNA_display
          , rownames = F
          , brushMode = "1D-axes"
          , reorderable = T
          , queue = T
          , color = list(
            colorScale = "scaleOrdinal"
            ,colorScheme = "schemeCategory10"
          )
          , withD3 = TRUE)

```

The graph shows a wide range of changes in different features, but we can still see that the iPhones produced in later years have more advanced and complete feature settings. For instance,  iPhone 11 to iPhone 13 all have comparatively high pixel densities and aspect ratios. Some early iPhones like iPhone 6 and iPhone 7 lack a lot of features like ProMotion Display, True Tone Display, etc. Overall, the features in the graph have a positive correlation with each other. For example, the iPhones with higher pixel densities also have higher aspect ratios. 

```{r}
r_display %>%
  ggplot(aes(x=1:nrow(r_display), y=ScreenSizeIn)) +
  #ggplot(aes(fct_inorder(Model), y=ScreenSizeIn))+
  geom_point() +
  geom_smooth(formula = y ~ x, method = "lm", se = FALSE) +
  #scale_x_continuous(Model) +????
  #theme(axis.text.x=element_text(angle=60,hjust = 1)) +
  xlab("iPhone Models (in order of release time)") +
  ggtitle("iPhone Screen Size (in) of Different Models")
```

Ignore the x-axis values. The x-axis value for each point is each iPhone model in the order of release time. 


```{r}
r_display %>% 
  ggplot(aes(x=ResX, y=ResY)) +
  geom_point() +
  geom_text(aes(label=Model), hjust=0.5, vjust=-0.5, check_overlap=T) +
  ggtitle("iPhone Resolution of Different Models")
```

(We checked the overlap models, and only keep one of them.)


### iPhone Rear Camera Table
For iPhone Rear Camera, we mainly care about some features as the following.
```{r}
part_rearcam <- r_rearcam[, c('Model', 'Camera', 'Aperture', 'Night Mode', 'Flash', 'Video Recording', 'Optical Image Stabilization')]

parcoords(part_rearcam
          , rownames = F
          , brushMode = "1D-axes"
          , reorderable = T
          , queue = T
          , color = list(
            colorScale = "scaleOrdinal"
            ,colorScheme = "schemeCategory10"
          )
          , withD3 = TRUE)
```


## Apple Fianance Data Analysis

```{r}
financeTable %>%
  mutate(Employees = ifelse(is.na(Employees), 0, Employees)) %>%
  ggplot(aes(x=Year,y=Employees))+
  geom_bar(stat="identity") +
  xlab("Year") +
  ylab("Numbers of Employees") +
  #scale_y_continuous(breaks = seq(0, 150000,len=1000)) +
  ggtitle("Numbers of Apple Employees from 2000 to 2020 ") +
  theme_bw()
```

```{r}
financeTable %>%
  ggplot(aes(Revenueinmil.USD,Employees))+
  geom_point() +
  theme(axis.text.x=element_text(angle=60,hjust = 1)) +
  xlab("Revenue in Million") +
  ylab("Number of Employees") +
  ggtitle("Revenue vs. Number of Employees from 2000-2020")+
  theme_bw()
```


## Customer Satisfaction

Apple and Samsung together dominated the individual brand rankings.

```{r}
cstable %>%
  ggplot(aes(x=reorder(Model, Satisfaction),y=Satisfaction))+
  geom_bar(stat = "identity")+
  xlab("Model") +
  ylab("Satisfaction Index 0-100 Scale") +
  ggtitle("Smartphone Customer Satisfaction 2021") +
  coord_flip()
```

```{r}
cstable %>%
  group_by(Manufacturer) %>%
  count() %>%
  ggplot(aes(x=Manufacturer, y=n)) +
  geom_bar(stat = "identity") +
  ylab("Number of Model") +
  ggtitle("Num of Models With Satisfaction >=75") +
  geom_text(aes(label=n), hjust=0.5, vjust=-0.5)
```

## Smartphones Comparison
maybe remove?
