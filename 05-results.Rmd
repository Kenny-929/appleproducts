# Results

```{r, include=FALSE}
# this prevents package loading message from appearing in the rendered version of your problem set
knitr::opts_chunk$set(warning = FALSE, message = FALSE,
                      echo = FALSE)
```

```{r}
library(rvest)
library(robotstxt)
library(tidyverse) 
library(patchwork)
library(naniar)
library(janitor)
library(vistime)
```

## Different iPhone Features Changing

In order for us to better understand how products are changing to suit the public’s varying needs, it is necessary to examine the change of products’ features over the year. As an iconic figure among all Apple products, iPhone can be a typical product for our analysis. In this section, we will take a deep analysis of the features of different generations of iPhone products, like the release date and discontinued date, display of the phone, and the rear camera mode. In our data cleaning section, we have obtained the data that contain that essential information, and we will utilize these data and a vast of R libraries including tidyverse, rvest, robotstxt, patchwork, naniar, janitor, and vistime to help our exploratory analysis.

### Release and Discontinued Date
Before we dive into the various features of the iPhone, we want to present a roadmap of when each iPhone was produced and when it was discontinued from production. For our purpose, we utilize the vistime library to draw the visualization. 
```{r}
vistime(iph_rel, col.event="Model", col.start = "ReleaseDate", col.end = "DisconDate", optimize_y = TRUE)
```

Vistime allows us to interact with the graph. If we point at the box where each iPhone is located, we can clearly see when the iPhone is produced and when it’s discontinued. As we can see from the graph, the earliest iPhone was produced in 2008, and it only lasts for one year. A similar fate can be seen on iPhone 3G or iPhone 5, where we can imply that Apple was facing certain challenges as they first started producing the iPhone product. As Apple continues on producing the iPhone products, we can see their production lasts longer than before, which may be caused by their more stabilized or newer technology. However, there is one thing we notice from the graph about the iPhone 4. Although it’s among one of the earliest iPhones, its production lasts comparatively longer than other early iPhones. This tells us that iPhone 4 symbolizes one of the early successes in Apply history. Also, starting from iPhone 4, Apple started producing iPhones more frequently and introducing more models.


```{r}
ggplot(iph_rel, aes(x=ReleaseYear)) +
  geom_bar(fill="lightpink", color = "black") +
  ggtitle("Number of iPhone Models Released in Each Year") +
  geom_text(aes(label=..count..), stat = 'count',hjust=0.5, vjust=-0.5) +
  theme_bw()
```

As we can see from the bar graph of numbers of the iPhones released each year, we can see that Apple continues to release more and more iPhone models in the last 15 years. Apple reaches at most 5 models in 2020. In particular, the year 2013 can be seen as a growth point of iPhone models. Before 2013, Apple only released one model a year, but after 2013, Apple started releasing more than 2 models a year. This implies that Apple reached success in making iPhone models in 2013, and they were more confident to produce more various models in the following years. This result is consistent with what we get from the Vistime plot. As we said, iPhone 4 can be seen as one of the early successes in Apple history. And if we look back at the production period of the iPhone 4, which is 2010-2013, we can see that the success of the iPhone 4 perfectly matches the growth point of the iPhone models. 

### iPhone Display Table
We found a dataset about the information of the display of each iPhone model. Given the dataset, we use a parallel coordinate plot to visualize the relationship among different iPhone features. Since the original dataset contains fairly detailed information about different features of iPhone models, for the sake of simplicity and clarity, we only selected a few important features that the most public care about when they select iPhones, including pixel density, aspect ratio, typical max brightness, contrast ratio, etc. To avoid the overlap of the feature names in the plot, we have abbreviated the feature names. 


```{r}
library(parcoords)
library(d3r)
library(RColorBrewer)

cleanNA_display <- r_display
cleanNA_display[is.na(cleanNA_display)] <- "NA"
colnames(cleanNA_display) <- abbreviate(names(cleanNA_display), minlength=5)

parcoords(cleanNA_display
          , rownames = F
          , brushMode = "1D-axes"
          , reorderable = T
          , queue = T
          , color = list(
            colorScale = "scaleOrdinal"
            ,colorScheme = "schemeCategory10"
          )
          , withD3 = TRUE)

```

This interactive plot shows a wide range of changes in different features of iPhones, and we can select certain features and see which iPhone models have those features. From this plot, we can see that the iPhones produced in later years have more advanced and complete feature settings. For instance, from iPhone 11 to iPhone 13, they all have comparatively high pixel densities and aspect ratios. Some early iPhones like iPhone 6 and iPhone 7 lack a lot of features like ProMotion Display, True Tone Display, etc. Overall, the features in the graph have a positive correlation with each other. For example, iPhones with higher pixel densities also have higher aspect ratios.


One of the most significant features of iPhone products has to be screen sizes. A larger screen size allows people to view more information at a time and handle more work on the phones. As iPhone starts to be used in more business tasks today, a larger screen size is heavily demanded by the public. In order to visualize this increasing demand, we graphed a scatter plot of screen sizes in different iPhone models. We set the x-axis in integer measures, which follows the order of the date when each model is released. Each point represents each iPhone model in the order of release time. The y axis is the measure of the screen size of each model. To show the trend of the scatter plot, we also included the best fitting lines that capture the trend of the overall change of screen sizes in different models. 


```{r}
r_display %>%
  ggplot(aes(x=1:nrow(r_display), y=ScreenSizeIn)) +
  #ggplot(aes(fct_inorder(Model), y=ScreenSizeIn))+
  geom_point() +
  geom_smooth(formula = y ~ x, method = "lm", se = FALSE) +
  #scale_x_continuous(Model) +???? we tried to modify the x axis to be the model names
  #theme(axis.text.x=element_text(angle=60,hjust = 1)) +
  xlab("iPhone Models (in order of release time)") +
  ggtitle("iPhone Screen Size (in) of Different Models") +
  theme_bw()
```

As we can see from the scatter plot, the minimum size of the iPhone screen is 4 inches, and the maximum size of screen is about 6.7 inches. The best-fitting line is shown in a positive slope. Therefore, we can clearly see that Apple continues to develop larger screen sizes in the last couple of years. There are a few outliers in the graph, like the 17th model released with only about 4.7 inches of screen size, and the 3rd model released with the minimum screen size value 4. This may be caused by the increasing need for different customer groups, for example, some teenagers who prefer smaller screen sizes, and Apple develops the iPhones to satisfy the demand of those customers.



```{r}
r_display %>% 
  ggplot(aes(x=ResX, y=ResY)) +
  geom_point() +
  geom_text(aes(label=Model), hjust=0.5, vjust=-0.5, check_overlap=T) +
  ggtitle("iPhone Resolution of Different Models") +
  theme_bw()
```

(We checked the overlap models, and only keep one of them.)


### iPhone Rear Camera Table
For iPhone Rear Camera, we mainly care about some features as the following.
```{r}
part_rearcam <- r_rearcam[, c('Model', 'Camera', 'Aperture', 'Night Mode', 'Flash', 'Video Recording', 'Optical Image Stabilization')]

parcoords(part_rearcam
          , rownames = F
          , brushMode = "1D-axes"
          , reorderable = T
          , queue = T
          , color = list(
            colorScale = "scaleOrdinal"
            ,colorScheme = "schemeCategory10"
          )
          , withD3 = TRUE)
```


## Apple Fianance Data Analysis

```{r}
financeTable %>%
  mutate(Employees = ifelse(is.na(Employees), 0, Employees)) %>%
  ggplot(aes(x=Year,y=Employees))+
  geom_bar(stat="identity", fill="lightpink", color = "black") +
  xlab("Year") +
  ylab("Numbers of Employees") +
  #scale_y_continuous(breaks = seq(0, 150000,len=1000)) +
  ggtitle("Numbers of Apple Employees from 2000 to 2020 ") +
  theme_bw()
```

```{r}
financeTable %>%
  mutate(Employees = ifelse(is.na(Employees), 0, Employees)) %>%
  ggplot(aes(Revenueinmil.USD,Employees))+
  geom_point() +
  theme(axis.text.x=element_text(angle=60,hjust = 1)) +
  xlab("Revenue in Million") +
  ylab("Number of Employees") +
  ggtitle("Revenue vs. Number of Employees from 2000-2020")+
  theme_bw()
```


## Customer Satisfaction

Apple and Samsung together dominated the individual brand rankings.

```{r}
cstable %>%
  ggplot(aes(x=reorder(Model, Satisfaction),y=Satisfaction))+
  geom_bar(stat = "identity", fill="lightpink", color = "black")+
  xlab("Model") +
  ylab("Satisfaction Index 0-100 Scale") +
  ggtitle("Smartphone Customer Satisfaction 2021") +
  scale_y_continuous(expand = expansion(add=c(-70,5))) +
  coord_flip() +
  theme_bw()
```

```{r}
cstable %>%
  group_by(Manufacturer) %>%
  count() %>%
  ggplot(aes(x=Manufacturer, y=n)) +
  geom_bar(stat = "identity", fill="lightpink", color = "black") +
  ylab("Number of Model") +
  ggtitle("Num of Models With Satisfaction >=75") +
  geom_text(aes(label=n), hjust=0.5, vjust=-0.5) +
  theme_bw()
```
